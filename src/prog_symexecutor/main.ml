(*****************************************************************************)
(*****************************************************************************)
(* Command Line Arguments                                                    *)
(*****************************************************************************)
(*****************************************************************************)

(* input file names *)
let ifnames : string list ref = ref []

(* output file names *)
let ofname  : string ref = ref ""


(*****************************************************************************)
(*****************************************************************************)
(* Argument Setting Functions                                                *)
(*****************************************************************************)
(*****************************************************************************)

(* default behavior *)
let set_ifnames s = ifnames := !ifnames @ [s]

let cmdParmas = [
  ("-o", Arg.Set_string ofname, "set output filename");
]


(*******************************************************************)
(*******************************************************************)
(* Toplevel Run                                                    *)
(*******************************************************************)
(*******************************************************************)

let _ =
  let usage_msg = Printf.sprintf "Usage: %s <input-file>" Sys.argv.(0) in
  Arg.parse cmdParmas set_ifnames usage_msg;
  let _ : unit = 
    if List.length !ifnames = 0
    then (print_endline usage_msg; failwith "No Arguments";)
    else ()
  in
  (* program behavior *)
  print_endline "PROGRAM ENDS"